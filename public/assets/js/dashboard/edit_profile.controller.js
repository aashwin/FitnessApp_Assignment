"use strict";!function(){var e=angular.module("app");e.controller("editProfileController",["userService","defaultProfilePic","Notification","$location","$scope","$routeParams",function(e,r,o,n,l,t){l.default_profile_pic=r,l.errored=!1,l.entryModel={},l.genders=[{label:"Undisclosed",value:0},{label:"Male",value:1},{label:"Female",value:2}],l.$watch(l.currentUser,function(e,r,o){if(l.entryModel=l.currentUser,l.entryModel.dob&&(l.entryModel.dobObj=moment(l.entryModel.dob)),l.entryModel.gender){for(var n=0;n<l.genders.length;n++)if(l.entryModel.gender==l.genders[n].value){l.entryModel.genderObj=l.genders[n];break}}else l.entryModel.genderObj=l.genders[0]}),l.deleteAccount=function(){var r=confirm("Are you sure you want to delete the account? Everything will be erased.");r&&e.delete(l.entryModel._id).then(function(){alert("Account Deleted"),location.href="/"},function(){l.entryModel.errors=["Something went wrong "]})},l.editProfile=function(){l.entryModel.errors=[];var r=l.entryModel;r.gender=l.entryModel.genderObj.value,l.entryModel.dobObj&&(r.dob=Math.round(l.entryModel.dobObj.valueOf()/1e3)),delete r.errors,e.edit(r).then(function(e){e.success?o.success({message:"Successfully updated your profile",delay:5e3}):l.entryModel.errors=e.errors})},l.upload=function(r){l.uploaderText="Uploading...",e.uploadProfilePic(r).then(function(e){l.uploaderText=null,e.success?(o.success({message:"Successfully updated your picture",delay:5e3}),l.uploaderText=null):l.uploaderText=e.errors},function(e){l.uploaderText=e.errors},function(e){l.uploaderText=e+"% uploaded."})}}])}();