"use strict";!function(){var e=angular.module("app");e.controller("editProfileController",["userService","defaultProfilePic","$location","$scope","$routeParams",function(e,r,o,n,t){n.default_profile_pic=r,n.errored=!1,n.entryModel={},n.genders=[{label:"Undisclosed",value:0},{label:"Male",value:1},{label:"Female",value:2}],n.$watch(e.currentUser,function(r){if(n.entryModel=e.currentUser,n.entryModel.dob&&(n.entryModel.dobObj=moment(n.entryModel.dob)),n.entryModel.gender){for(var o=0;o<n.genders.length;o++)if(n.entryModel.gender==n.genders[o].value){n.entryModel.genderObj=n.genders[o];break}}else n.entryModel.genderObj=n.genders[0]}),n.deleteAccount=function(){var r=confirm("Are you sure you want to delete the account? Everything will be erased.");r&&e.delete(n.entryModel._id).then(function(){alert("Account Deleted"),location.href="/"},function(){n.entryModel.errors=["Something went wrong "]})},n.editProfile=function(){n.entryModel.errors=[];var r=n.entryModel;r.gender=n.entryModel.genderObj.value,r.dob=Math.round(n.entryModel.dobObj.valueOf()/1e3),delete r.errors,e.edit(r).then(function(e){e.success?o.path("app/users/edit-profile"):n.entryModel.errors=e.errors})},n.upload=function(r){n.uploaderText="Uploading...",e.uploadProfilePic(r).then(function(e){n.uploaderText=null,e.success?n.uploaderText:n.uploaderText=e.errors},function(e){n.uploaderText=e.errors},function(e){n.uploaderText=e+"% uploaded."})}}])}();