"use strict";!function(){var t=angular.module("app");t.controller("activityController",["activityService","userService","Notification","defaultProfilePic","$location","$scope","$routeParams",function(t,e,o,c,n,i,r){i.activity={name:"Loading..."},i.default_profile_pic=c,i.comments={errors:[],list:[],count:0},i.comment="",i.mapPathData=[],t.get(r.id).then(function(t){return t.success&&t.object?void(i.activity=t.object):void(location.href="/app/404/")},function(){location.href="/app/404/"}),t.getTrackPoints(r.id).then(function(t){if(t.success&&t.object&&t.object instanceof Array)for(var e=0;e<t.object.length;e++)i.mapPathData.push([t.object[e].lat,t.object[e].long])});var a=5,s=1;i.loadMoreComments=function(){t.getComments(r.id,{limit:a,page:s,sort_field:"created_at",sort_by:"asc"}).then(function(t){t.success&&t.object&&t.object instanceof Array&&(i.comments.list=i.comments.list.concat(t.object),i.comments.count=t.count||0,s++)})},i.loadMoreComments(),i.addActivityComment=function(){t.addComment({activityId:i.activity._id,commentText:i.comment}).then(function(t){t.success?(t.object.createdBy=i.currentUser,i.comments.list.push(t.object),i.comments.count++,i.comments.errors=[],i.comment="",i.errored=!1):(i.comments.errors=t.errors,i.errored=!0)},function(t){i.comments.errors=t.errors,i.errored=!0})},i.editActivity=function(){n.path("/app/activity/"+i.activity._id+"/edit")},i.deleteActivity=function(){var e=confirm("Are you sure you want to delete the activity? Everything will be erased.");e&&t.delete(i.activity._id).then(function(t){t.success?(n.path("/app/"),o.success({message:"Successfully deleted activity",delay:5e3})):o.error({message:"Something went wrong",delay:5e3})},function(){o.error({message:"Something went wrong",delay:5e3})})}}])}();