"use strict";!function(){var e=angular.module("app");e.controller("activityController",["activityService","userService","Notification","defaultProfilePic","$location","$scope","$routeParams",function(e,t,o,c,n,r,i){r.activity={name:"Loading..."},r.default_profile_pic=c,r.comments={errors:[],list:[],count:0},r.comment="",r.mapPathData=[],e.get(i.id).then(function(e){return e.success&&e.object?void(r.activity=e.object):void(location.href="/app/404/")},function(){location.href="/app/404/"}),e.getTrackPoints(i.id).then(function(e){if(e.success&&e.object&&e.object instanceof Array)for(var t=0;t<e.object.length;t++)r.mapPathData.push([e.object[t].lat,e.object[t].long])});var s=5,a=1;r.loadMoreComments=function(){e.getComments(i.id,{limit:s,page:a,sort_field:"created_at",sort_by:"asc"}).then(function(e){e.success&&e.object&&e.object instanceof Array&&(r.comments.list=r.comments.list.concat(e.object),r.comments.count=e.count||0,a++)})},r.loadMoreComments(),r.addActivityComment=function(){e.addComment({activityId:r.activity._id,commentText:r.comment}).then(function(e){e.success?(e.object.createdBy=r.currentUser,r.comments.list.push(e.object),r.comments.count++,r.comments.errors=[],r.comment="",r.errored=!1):(r.comments.errors=e.errors,r.errored=!0)},function(e){r.comments.errors=e.errors,r.errored=!0})},r.deleteActivity=function(){var t=confirm("Are you sure you want to delete the activity? Everything will be erased.");t&&e.delete(r.activity._id).then(function(e){e.success?(n.path("/app/"),o.success({message:"Successfully deleted activity",delay:5e3})):o.error({message:"Something went wrong",delay:5e3})},function(){o.error({message:"Something went wrong",delay:5e3})})}}])}();