"use strict";!function(){var e=angular.module("app");e.controller("createActivityController",["userService","activityService","$location","$scope","$routeParams",function(e,r,o,t,a){t.entryMode=0,t.errored=!1,"manual"==a.method?t.entryMode=1:"gpx"==a.method&&(t.entryMode=2),t.activityTypes=[{value:1,label:"Run"},{value:2,label:"Walk"},{value:3,label:"Cycle"}],t.measurementTypes=[{value:1609.34,label:"Miles"},{value:1e3,label:"KM"},{value:1,label:"Meters"}];var l=new Date;l.setHours(0),l.setMinutes(0),l.setSeconds(0),t.manualEntryModel={errors:[],activityType:t.activityTypes[0],distanceType:t.measurementTypes[0],dateTimeObj:moment(l)},t.gpxUploadModel={errors:[],activityType:t.activityTypes[0]},t.addActivityManual=function(){t.manualEntryModel.errors=[],t.manualEntryModel.dateTime=Math.round(t.manualEntryModel.dateTimeObj.valueOf()/1e3),r.create(t.manualEntryModel).then(function(e){e.success?(t.errored=!1,o.path("/app/activity/"+e.object._id)):(t.manualEntryModel.errors=e.errors,t.errored=!0)},function(e){t.manualEntryModel.errors=e.errors,t.errored=!0})},t.uploadPercent=null,t.uploadGpx=function(){return t.gpxUpload.$invalid?(t.gpxUploadModel.errors=["Fix the highlighted issues before continuing..."],void(t.errored=!0)):(t.gpxUploadModel.errors=[],void r.createUploader(t.gpxUploadModel).then(function(e){t.uploadPercent=null,e.success?(t.errored=!1,o.path("/app/activity/"+e.object._id)):(t.gpxUploadModel.errors=e.errors,t.errored=!0)},function(e){t.gpxUploadModel.errors=["Something went wrong, try again!"],t.errored=!0},function(e){t.uploadPercent=e+"%"}))}}])}();